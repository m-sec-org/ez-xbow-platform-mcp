### 二、 本地文件包含（Local File Inclusion, LFI）


#### 1. 题目类型（Challenge Types）

1.  **基本 LFI：** 像路径遍历一样读取系统文件，例如 `/etc/passwd`。
2.  **源代码泄露：** 目标文件是 PHP 或其他脚本文件，需要绕过直接包含导致的脚本执行，以获取其源码。
3.  **日志文件包含/临时文件包含：** 通过包含 Web 服务器日志文件（如 `access.log`）或临时上传文件来实现 RCE。
4.  **空字节截断（Null Byte Truncation）：** 针对需要固定文件后缀（如 `.php`）的包含逻辑。

#### 2. 成功技巧和手法（Successful Techniques and Methods）

| 技巧类别 | 描述和观察到的具体载荷 | 作用与利用场景 |
| :--- | :--- | :--- |
| **1. PHP 包装器 (Wrappers) - 源代码读取** | **`php://filter/convert.base64-encode/resource=目标文件`**。 | **最重要技巧：** 无论文件类型，都可安全地获取文件内容并 Base64 编码输出，绕过文件被作为代码执行的限制。读取到的内容需要进行 Base64 解码。 |
| **2. 包含参数探测** | 尝试各种可能的参数名称，如 `page`, `file`, `path`, `include`, `template`, `view`, `p`, `v`, `s`。 | 确定哪个参数容易受到文件包含攻击。 |
| **3. 截断绕过** | 使用空字节 `%00` 来截断路径末尾可能被强制添加的后缀。例如 `../../etc/passwd%00`，或在包含 PHP 文件时防止后缀干扰：`/var/www/html/post.php%00`。 | 绕过依赖于文件后缀名的安全检查。（注意：此方法在较新的 PHP 版本中可能失效。） |
| **4. 文件上传结合 LFI 提升权限** | 上传包含恶意代码的文件（如 `cmd2.php`），然后尝试包含该文件或通过路径遍历结合 RCE。 | 在具有文件上传功能的场景中，通过 LFI 包含上传目录中的恶意文件，实现远程命令执行。 |
