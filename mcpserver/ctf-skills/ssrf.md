### 一、协议滥用与本地文件读取型 (Protocol Abuse & LFI)

这类攻击旨在利用 URL 协议的特性，让服务器读取其内部的文件内容，绕过 Web 服务的限制。

| 序号 | 做题技巧/手法 | 详细描述 |
| :--- | :--- | :--- |
| **1** | **`file://` 协议直接读取** | 利用 `file:///` 协议（或其编码形式）直接访问服务器本地文件系统的敏感文件，如配置文件、标志文件 (`flag`) 或源码。 |
| **2** | **PHP 包装器 (Wrapper) 滥用** | 针对 PHP 应用，使用如 `php://filter/convert.base64-encode/resource=` 包装器，将目标文件内容进行 Base64 编码后输出，从而绕过输出过滤或内容类型限制。 |
| **3** | **目录遍历/路径穿越** | 通过在路径中使用 `../` (或其各种编码形式) 来访问应用程序根目录以外的文件，例如读取 `/etc/passwd` 或其他敏感文件。 |
| **4** | **路径编码混淆绕过** | 使用非标准或多重 URL 编码绕过过滤器的正则表达式检测，例如使用 `%252f` (双重编码的斜杠) 或 `%c0%af` (UTF-8 超长编码的斜杠)。 |
| **5** | **空字节截断** | 利用空字节 `%00` 来截断文件路径中用于验证文件类型的后缀（如 `.jpg`），以实现 LFI 攻击。 |

---

### 二、绕过与请求头部注入型 (Bypasses & Request Injection)

当目标应用程序对用户提供的 URL 进行了过滤和限制时，需要使用复杂的技巧来绕过限制，或注入恶意数据。

| 序号 | 做题技巧/手法 | 详细描述 |
| :--- | :--- | :--- |
| **9** | **CRLF/请求头注入** | 在 URL 参数中注入回车和换行符 (`%0d%0a`)，从而在服务器向后端服务发起的请求中注入自定义 HTTP 头部，实现绕过内部认证或修改请求体。 |
| **10** | **Host 头部欺骗/绕过** | 通过修改外部请求的 `Host` 头部，使其看起来像是来自内部域名（如 `localhost` 或 `internal.router`），从而绕过基于域名的白名单检查，或访问特定于内部域名的资源。 |
| **11** | **伪造 IP 源地址头部** | 尝试注入或修改用于识别客户端 IP 的 HTTP 头部（如 `X-Forwarded-For`、`X-Real-IP`），将请求伪装成来自本地 (`127.0.0.1`)，以访问需要本地权限的资源。 |
| **12** | **路径重写头部（非标准）** | 利用代理服务器或 Web 应用框架中可能存在的路径重写逻辑，通过 `X-Original-URL` 或 `X-Rewrite-URL` 等头部强制服务器访问内部路径或敏感文件。 |

---

### 三、混合与衍生攻击型 (Hybrid & Consequence Attacks)

SSRF 往往作为攻击链的起点或辅助工具，与其他漏洞结合使用，以达到更高的权限或远程代码执行。

| 序号 | 做题技巧/手法 | 详细描述 |
| :--- | :--- | :--- |
| **13** | **SSRF + RCE/SSTI** | 利用 SSRF 成功访问内部服务后，对该内部服务尝试进行服务器端模板注入 (SSTI) 或远程命令执行 (RCE) 攻击，以获取控制权或读取文件。 |
| **14** | **SSRF + XXE（实体请求）** | 当服务器解析 XML 输入时，攻击者可以通过定义外部实体（如 `<!ENTITY xxe SYSTEM "file:///etc/hostname">`）来触发对本地文件或内部网络的请求，这本质上是利用了 XML 解析器的 SSRF 能力。 |
