
### 一、 任意文件读取（Arbitrary File Read）/ 路径遍历（Path Traversal）

**路径遍历**是实现任意文件读取最直接的技术手段。题目通常要求通过操纵 URL 参数或请求头，利用相对路径机制 (`../` 或其编码形式) 来访问文件系统根目录之外的文件。

#### 1. 题目类型（Challenge Types）

1.  **基础路径跳跃：** 应用程序直接拼接用户输入的文件名，未检查 `../` 序列。
2.  **Web 根目录逃逸：** 应用程序限制用户只能访问特定目录（如 `/static/` 或 `/images/`），要求攻击者构造路径绕过该限制来读取更高层级的文件。例如，尝试访问 `/icons/..%2f/flag.txt` 或 `/static/../flag.txt`。
3.  **目录规范化绕过：** 应用程序尝试过滤 `../`，但可以利用编码或非标准路径格式进行绕过。
4.  **结合 SSRF 的文件读取：** 应用程序存在 SSRF (Server-Side Request Forgery) 漏洞，允许攻击者通过 `file:///` 协议读取本地文件。

#### 2. 技巧和手法（Techniques and Methods）

| 技巧类别 | 描述和观察到的具体载荷 | 作用与利用场景 |
| :--- | :--- | :--- |
| **1. 基础遍历与目标文件探测** | 使用多层 `../` 尝试访问系统文件，例如：`../../../../etc/passwd` 或直接探测旗标文件：`/flag`、`/flag.txt`、`/FLAG.php`。 | 确认路径遍历漏洞是否存在，并定位关键系统文件和目标旗标。 |
| **2. 标准编码绕过** | 对 `../` 或 `/` 进行单次 URL 编码：`..%2f`，或使用点分编码 `/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。 | 绕过简单过滤器的首选方法。 |
| **3. 双重编码绕过 (Double Encoding)** | 对编码后的路径再次编码，例如 `..%252f..%252fetc%252fpasswd`。 | 针对在过滤前进行一次 URL 解码的应用程序。 |
| **4. 混合/非标准编码及填充** | 尝试利用操作系统或 Web 服务器的路径规范化特性，例如使用过多的点或斜线：`....//....//etc/passwd`。或者使用非标准编码如 `..%c0%af`。 | 绕过依赖于严格字符串匹配的过滤器，利用解析器差异。 |
| **5. 静态目录逃逸** | 利用应用中已知的静态资源路径作为起点，进行目录跳跃，例如 `/icons/..%2fflag.txt` 或 `/static/../flag.txt`。 | 绕过要求从特定子目录开始的路径验证。 |
| **6. SSRF + `file://` 协议** | 在具有 SSRF 功能的端点（如某些插件或服务）中，强制服务器使用 `file:///` 协议读取本地文件。例如，在 WordPress 插件场景中：`ajax.php?action=restore&bm_url=file:///opt/flag.txt`。 | 利用服务器内部文件读取能力，即使外部访问路径受限。 |

